# Система продажу квитків автовокзалу

WPF додаток для продажу квитків автовокзалу з використанням 12 шаблонів проєктування.

## Використані шаблони проєктування

### 1. **Observer (Спостерігач)**
- **Призначення**: Сповіщення про зміни в системі (створення, скасування квитків)
- **Реалізація**: 
  - `ITicketObserver` - інтерфейс спостерігача
  - `TicketSubject` - об'єкт, за яким спостерігають
  - `LoggingObserver` - логування подій
  - `JsonSaveObserver` - автоматичне збереження в JSON при змінах

### 2. **Visitor (Відвідувач)**
- **Призначення**: Обробка різних типів об'єктів (Ticket, Route, Passenger) при серіалізації
- **Реалізація**: 
  - `ITicketVisitor` - інтерфейс відвідувача
  - `JsonSerializationVisitor` - серіалізація об'єктів в JSON формат

### 3. **Strategy (Стратегія)**
- **Призначення**: Різні стратегії оплати (готівка, картка, онлайн) з різними знижками
- **Реалізація**: 
  - `IPaymentStrategy` - інтерфейс стратегії
  - `CashPaymentStrategy` - готівка (без знижки)
  - `CardPaymentStrategy` - картка (знижка 2%)
  - `OnlinePaymentStrategy` - онлайн (знижка 5%)

### 4. **Factory (Фабрика)**
- **Призначення**: Створення квитків різних типів (звичайний, пільговий, дитячий)
- **Реалізація**: 
  - `ITicketFactory` - інтерфейс фабрики
  - `RegularTicketFactory` - звичайні квитки
  - `DiscountTicketFactory` - пільгові квитки (знижка 30%)
  - `ChildTicketFactory` - дитячі квитки (знижка 50%)
  - `TicketFactoryProvider` - провайдер фабрик

### 5. **Builder (Будівник)**
- **Призначення**: Побудова складних об'єктів квитків з кроковим налаштуванням
- **Реалізація**: 
  - `TicketBuilder` - будівник квитків з методом ланцюжкового виклику

### 6. **Command (Команда)**
- **Призначення**: Інкапсуляція операцій з квитками (покупка, скасування) з можливістю відміни
- **Реалізація**: 
  - `ICommand` - інтерфейс команди
  - `BuyTicketCommand` - команда покупки квитка
  - `CancelTicketCommand` - команда скасування квитка

### 7. **Singleton (Одинак)**
- **Призначення**: Гарантує один екземпляр репозиторію та один JSON файл для всіх операцій зберігання
- **Реалізація**: 
  - `JsonTicketRepository.Instance` - єдиний екземпляр репозиторію
  - Thread-safe реалізація з lock для безпечної роботи в багатопоточності
  - Всі операції (додавання, видалення, оновлення, збереження) працюють з одним JSON файлом

### 8. **Repository (Репозиторій)**
- **Призначення**: Абстракція доступу до даних, збереження в JSON файл
- **Реалізація**: 
  - `ITicketRepository` - інтерфейс репозиторію
  - `JsonTicketRepository` - реалізація з JSON файлом як базою даних (використовує Singleton)

### 9. **Decorator (Декоратор)**
- **Призначення**: Додавання додаткових послуг до квитків (страхування, багаж)
- **Реалізація**: 
  - `ITicketDecorator` - інтерфейс декоратора
  - `InsuranceDecorator` - додавання страхування (+50 грн)
  - `BaggageDecorator` - додавання багажу (+30 грн)

### 10. **Template Method (Шаблонний метод)**
- **Призначення**: Визначення структури алгоритму обробки квитків
- **Реалізація**: 
  - `TicketProcessor` - абстрактний клас з шаблонним методом
  - `StandardTicketProcessor` - конкретна реалізація обробки

### 11. **State (Стан)**
- **Призначення**: Управління станами квитків (Active, Cancelled, Used)
- **Реалізація**: 
  - `ITicketState` - інтерфейс стану
  - `ActiveTicketState` - активний стан
  - `CancelledTicketState` - скасований стан
  - `UsedTicketState` - використаний стан
  - `TicketStateContext` - контекст для управління станами

### 12. **Composite (Компонувальний)** + **Builder (Будівник)**
- **Призначення**: Створення структури меню додатка через Composite pattern та побудова через Builder
- **Реалізація**: 
  - `IMenuComponent` - інтерфейс компонента меню
  - `MenuItemLeaf` - листок (окремий пункт меню)
  - `MenuItemComposite` - композит (підменю з дочірніми елементами)
  - `MenuBuilder` - будівник меню з методом ланцюжкового виклику
  - Меню включає: Файл, Квитки, Маршрути, Допомога

## Структура проекту

```
BusStationTicketSystem/
├── Models/
│   ├── Route.cs
│   ├── Passenger.cs
│   ├── Ticket.cs
│   └── TicketData.cs
├── Patterns/
│   ├── Observer/
│   ├── Visitor/
│   ├── Strategy/
│   ├── Factory/
│   ├── Builder/
│   ├── Command/
│   ├── Repository/
│   ├── Decorator/
│   ├── TemplateMethod/
│   ├── State/
│   └── Composite/
├── App.xaml
├── App.xaml.cs
├── MainWindow.xaml
├── MainWindow.xaml.cs
└── BusStationTicketSystem.csproj
```

## Функціональність

- **Меню додатка** (Composite + Builder) з розділами: Файл, Квитки, Маршрути, Допомога
- Продаж квитків з вибором маршруту, типу квитка, способу оплати
- Додавання додаткових послуг (страхування, багаж)
- Перегляд списку квитків
- Скасування квитків
- Експорт даних (Visitor pattern)
- Статистика квитків
- Автоматичне збереження в JSON файл
- Логування операцій

## Запуск

### Варіант 1: Використання batch файлів (рекомендовано)

1. **Збірка проекту:**
   - Запустіть `build.bat` для Release збірки
   - Або `build_debug.bat` для Debug збірки

2. **Запуск програми:**
   - Запустіть `run.bat` для запуску зібраного проекту
   - Або `build_and_run.bat` для збірки та запуску одразу

3. **Очищення:**
   - Запустіть `clean.bat` для видалення папок bin та obj

### Варіант 2: Visual Studio

1. Відкрити проект в Visual Studio
2. Збілдити проект (Build)
3. Запустити (F5)

### Варіант 3: Командний рядок

```bash
# Збірка
dotnet build BusStationTicketSystem.csproj --configuration Release

# Запуск
dotnet run --project BusStationTicketSystem.csproj
```

Дані зберігаються в файлі `tickets_data.json` в директорії виконання програми.
